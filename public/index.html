<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StockTrader Pro - Live Market Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.5.0/dist/chart.umd.js"></script>
    <link rel="stylesheet" href="style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="trading-platform">
        <!-- Market Header with Live Data -->
        <header class="market-header">
            <div class="header-content">
                <div class="platform-brand">
                    <i class="fas fa-chart-line"></i>
                    <h1>PROFET</h1>
                    <span class="beta-badge">LIVE</span>
                </div>
                <div class="header-center">
                    <div class="market-status">
                        <div class="status-item">
                            <span class="status-label">Market Status:</span>
                            <span class="status-value market-open">
                                <i class="fas fa-circle"></i> OPEN
                            </span>
                        </div>
                        <div class="status-item">
                            <span class="status-label">Last Update:</span>
                            <span class="status-value" id="lastUpdateTime">Live</span>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Quick Stats Bar -->
        <div class="quick-stats-bar">
            <div class="stat-ticker">
                <div class="ticker-item">
                    <span class="ticker-symbol">S&P 500</span>
                    <span class="ticker-value positive">4,567.89</span>
                    <span class="ticker-change positive">+1.2%</span>
                </div>
                <div class="ticker-item">
                    <span class="ticker-symbol">NASDAQ</span>
                    <span class="ticker-value positive">14,321.45</span>
                    <span class="ticker-change positive">+0.8%</span>
                </div>
                <div class="ticker-item">
                    <span class="ticker-symbol">DOW</span>
                    <span class="ticker-value negative">35,678.12</span>
                    <span class="ticker-change negative">-0.3%</span>
                </div>
            </div>
        </div>
        
        <div class="trading-workspace">
            <!-- Available Stocks Market Panel - Compact Layout -->
            <div class="market-stocks-panel compact-stocks">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2><i class="fas fa-list"></i> Available Stocks</h2>
                    <div class="price-legend">
                        <span style="display: flex; align-items: center; gap: 15px; font-size: 0.9em; color: #9ca3af;">
                            <span style="display: flex; align-items: center; gap: 5px;">
                                <i class="fas fa-circle" style="color: #10b981; font-size: 0.6em;"></i>
                                Live Price
                            </span>
                            <span style="display: flex; align-items: center; gap: 5px;">
                                <i class="fas fa-circle" style="color: #9ca3af; font-size: 0.6em;"></i>
                                Demo Price
                            </span>
                        </span>
                    </div>
                </div>
                <div id="availableStocks" class="stocks-grid-compact"></div>
            </div>

            <!-- Quick Trade Panel -->
            <div class="trading-panel">
                <h2><i class="fas fa-bolt"></i> Quick Trade</h2>
                
                <!-- Wallet Section -->
                <div class="wallet-section">
                    <div class="wallet-info">
                        <div class="wallet-balance">
                            <i class="fas fa-wallet"></i>
                            <span class="balance-label">Available Balance:</span>
                            <span class="balance-value" id="walletBalance">$0.00</span>
                        </div>
                        <div class="wallet-actions">
                            <button type="button" class="wallet-btn add-funds" onclick="showAddFundsModal()">
                                <i class="fas fa-plus"></i> Add Funds
                            </button>
                            <button type="button" class="wallet-btn withdraw-funds" onclick="showWithdrawModal()">
                                <i class="fas fa-minus"></i> Withdraw
                            </button>
                        </div>
                    </div>
                </div>
                
                <form id="stockForm" class="trade-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="stockSearch"><i class="fas fa-search"></i> Stock Symbol</label>
                            <div class="search-container">
                                <input type="text" id="stockSearch" placeholder="Enter symbol (AAPL, TSLA, GOOGL...)" autocomplete="off">
                                <div class="suggestions" id="suggestions"></div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="quantity"><i class="fas fa-layer-group"></i> Shares</label>
                            <input type="number" id="quantity" min="1" placeholder="0" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="price"><i class="fas fa-dollar-sign"></i> Price per Share</label>
                            <input type="number" id="price" step="0.01" min="0.01" placeholder="0.00" required>
                        </div>
                    </div>

                    <!-- Trade Cost Preview -->
                    <div class="trade-preview" id="tradePreview" style="display: none;">
                        <div class="preview-item">
                            <span>Trade Cost:</span>
                            <span id="tradeCost">$0.00</span>
                        </div>
                        <div class="preview-item">
                            <span>After Trade:</span>
                            <span id="afterTradeBalance">$0.00</span>
                        </div>
                    </div>
                    
                    <div class="trading-buttons">
                        <button type="submit" name="action" value="buy" class="trade-btn buy-order">
                            <i class="fas fa-arrow-up"></i> BUY
                        </button>
                        <button type="submit" name="action" value="sell" class="trade-btn sell-order">
                            <i class="fas fa-arrow-down"></i> SELL
                        </button>
                    </div>
                </form>
                
                <div class="trading-alerts">
                    <div class="alert error-alert" id="errorMessage"></div>
                    <div class="alert success-alert" id="successMessage"></div>
                </div>
            </div>

            <!-- Portfolio Value History - Market Style -->
            <div class="market-chart-panel">
                <div class="chart-header">
                    <h2><i class="fas fa-chart-area"></i> Portfolio Performance</h2>
                    <div class="chart-controls">
                        <button class="time-period active">1D</button>
                        <button class="time-period">1W</button>
                        <button class="time-period">1M</button>
                        <button class="time-period">1Y</button>
                        <button class="time-period">ALL</button>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="historyChart"></canvas>
                </div>
            </div>

            <!-- Portfolio Holdings - Trading Style -->
            <div class="portfolio-dashboard">
                <div class="dashboard-header">
                    <h2><i class="fas fa-briefcase"></i> My Portfolio Holdings</h2>
                    <div class="portfolio-controls">
                        <button id="refreshPricesBtn" class="refresh-btn">
                            <i class="fas fa-sync-alt"></i> Refresh
                        </button>
                    </div>
                </div>
                
                <!-- Portfolio Summary Cards -->
                <div id="portfolioSummary" class="portfolio-summary" style="display: none;">
                    <div class="summary-cards">
                        <div class="summary-card total-value">
                            <div class="card-icon"><i class="fas fa-chart-pie"></i></div>
                            <div class="card-content">
                                <div class="card-label">Your Total Value </div>
                                <div class="card-value" id="totalValue">$0.00</div>
                            </div>
                        </div>
                        <div class="summary-card">
                            <div class="card-icon"><i class="fas fa-coins"></i></div>
                            <div class="card-content">
                                <div class="card-label">Total Stocks</div>
                                <div class="card-value" id="totalStocks">0</div>
                            </div>
                        </div>
                        <div class="summary-card">
                            <div class="card-icon"><i class="fas fa-layer-group"></i></div>
                            <div class="card-content">
                                <div class="card-label">Total Shares</div>
                                <div class="card-value" id="totalShares">0</div>
                            </div>
                        </div>
                        <div class="summary-card">
                            <div class="card-icon"><i class="fas fa-dollar-sign"></i></div>
                            <div class="card-content">
                                <div class="card-label">Total Invested</div>
                                <div class="card-value" id="totalInvested">$0.00</div>
                            </div>
                        </div>
                        <div class="summary-card">
                            <div class="card-icon"><i class="fas fa-calculator"></i></div>
                            <div class="card-content">
                                <div class="card-label">Avg. Price</div>
                                <div class="card-value" id="avgPrice">$0.00</div>
                            </div>
                        </div>
                    </div>
                    <div class="last-updated" id="lastUpdated">Prices last updated: Never</div>
                </div>
                
                <!-- Holdings Table -->
                <div id="portfolio" class="holdings-grid"></div>
            </div>

            <!-- Market Analytics - Moved to End -->
            <div class="analytics-panel">
                <h2><i class="fas fa-analytics"></i> Portfolio Analytics</h2>
                <div class="charts-grid">
                    <div class="chart-widget">
                        <h3>Distribution</h3>
                        <canvas id="pieChart"></canvas>
                    </div>
                    <div class="chart-widget">
                        <h3>Stock Values</h3>
                        <canvas id="barChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Wallet Modals -->
    <div id="addFundsModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-plus-circle"></i> Add Funds to Wallet</h3>
                <span class="close" onclick="closeModal('addFundsModal')">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="addAmount">Amount to Add ($)</label>
                    <input type="number" id="addAmount" step="0.01" min="0.01" placeholder="0.00" required>
                </div>
                <div class="quick-amounts">
                    <button type="button" onclick="setAmount('addAmount', 100)">$100</button>
                    <button type="button" onclick="setAmount('addAmount', 500)">$500</button>
                    <button type="button" onclick="setAmount('addAmount', 1000)">$1,000</button>
                    <button type="button" onclick="setAmount('addAmount', 5000)">$5,000</button>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary" onclick="closeModal('addFundsModal')">Cancel</button>
                <button type="button" class="btn-primary" onclick="addFunds()">Add Funds</button>
            </div>
        </div>
    </div>

    <div id="withdrawModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-minus-circle"></i> Withdraw Funds</h3>
                <span class="close" onclick="closeModal('withdrawModal')">&times;</span>
            </div>
            <div class="modal-body">
                <div class="current-balance-info">
                    <strong>Available Balance: <span id="modalWalletBalance">$0.00</span></strong>
                </div>
                <div class="form-group">
                    <label for="withdrawAmount">Amount to Withdraw ($)</label>
                    <input type="number" id="withdrawAmount" step="0.01" min="0.01" placeholder="0.00" required>
                </div>
                <div class="quick-amounts">
                    <button type="button" onclick="setAmount('withdrawAmount', 100)">$100</button>
                    <button type="button" onclick="setAmount('withdrawAmount', 500)">$500</button>
                    <button type="button" onclick="setAmount('withdrawAmount', 1000)">$1,000</button>
                    <button type="button" onclick="setMaxWithdraw()">All</button>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary" onclick="closeModal('withdrawModal')">Cancel</button>
                <button type="button" class="btn-primary" onclick="withdrawFunds()">Withdraw</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
